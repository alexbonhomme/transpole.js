/*! transpole.js - v0.1.0 - 2015-12-27 - Alexandre Bonhomme */
!function(a){function b(a){"use strict";function b(a){if(!(this instanceof b))return new b(a);if(a=a||{},!a.apiProxyUrl)throw new Error("You have to provide a proxy URL.");return this.apiProxyBase=a.apiProxyUrl,this}function c(a,c){var e=this.apiProxyBase+"/"+a+"/"+d;return b.requestJSON(e,c)}var d="9d16ee6b-15a1-4963-bdeb-54d15dc27365";a.Transpole=b,b.prototype.lines=function(){return c.call(this,"lines").then(function(a){return a?a.lines:[]})},b.prototype.stops=function(){return c.call(this,"stops").then(function(a){return a?a.stops:[]})},b.prototype.next=function(a,b,d){var e={lineId:a,stopId:b,wayId:d};return c.call(this,"nextSchedule",e)}}function c(a){"use strict";function b(a){var b,c=[];for(b in a)a.hasOwnProperty(b)&&c.push(b+"="+a[b]);return c.join("&")}var c=a.Transpole;c.requestJSON=function(a,d){return new c.Promise(function(c,e){var f=new window.XMLHttpRequest,g=a;d&&(g+="?"+b(d)),f.open("GET",g),f.responseType="json",f.addEventListener("load",function(a){var b=a.target;200===b.status?b.response&&b.response.message?e(b.response.message):c(b.response):e(b.statusText)}),f.addEventListener("error",function(a){e(a.target.statusText)}),f.send()})}}function d(a){"use strict";function b(a){var b=typeof a;if(a&&("object"===b||"function"===b)){var c=a.then;if("function"==typeof c)return c}return null}function c(a,b,c){var d=!1;try{a(function(a){d||(d=!0,b(a))},function(a){d||(d=!0,c(a))})}catch(e){if(d)return;d=!0,c(e)}}function d(a){function e(a){l=g,m=a,n.forEach(k),n=[]}function i(a){l=h,m=a,n.forEach(k),n=[]}function j(a){try{var d=b(a);if(d)return void c(d.bind(a),j,i);e(a)}catch(f){i(f)}}function k(a){l===f?n.push(a):(l===g&&"function"==typeof a.onFulfilled&&a.onFulfilled(m),l===h&&"function"==typeof a.onRejected&&a.onRejected(m))}if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof a)throw new TypeError("fn must be a function");var l=f,m=null,n=[];this.done=function(a,b){setTimeout(function(){k({onFulfilled:a,onRejected:b})},0)},this.then=function(a,b){var c=this;return new d(function(d,e){return c.done(function(b){if("function"!=typeof a)return d(b);try{return d(a(b))}catch(c){return e(c)}},function(a){if("function"!=typeof b)return e(a);try{return d(b(a))}catch(c){return e(c)}})})},c(a,j,i)}var e=a.Transpole,f=0,g=1,h=2;e.Promise=d}var e=function(a){"use strict";return b(a),c(a),d(a),a.transpole};"function"==typeof define&&define.amd?define(function(){"use strict";return e({})}):e(this)}(this);